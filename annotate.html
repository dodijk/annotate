{% set title = "Annotate" %}
{% extends "template.html" %}
{% block container %}
      <h1>Annotate</h1>
      <p class="lead">Listen to the following piece of audio and rate it.</p>
        
      <div class="row">
        <form method="post">
          <input type="hidden" name="content_id" value="{{ content.key.urlsafe() }}" />
          <div class="well col-md-6 col-md-offset-3 text-center">
            <div>{{ content.content }}</div>
                      
            <div class="rating">
                {% for star in range(NUMBER_OF_STARS) %}
                    <span class="star"></span>
                {% endfor %}
            </div>
          </div>        
        </form>
      </div>
      
{% endblock %}
{% block script %}
<script type="text/javascript">
$( document ).ready(function() {
    // Handle clicks on stars
    $("form .rating span.star").click(function() {
        var stars = {{ NUMBER_OF_STARS }}-$(this).index();
        var form = $(this).closest("form");
        rate(form, stars);
    });
    
    function rate(form, stars) {
        form.find(".rating span.star").fadeOut();
        form.append('<input type="hidden" name="stars" value="'+stars+'" />');
        form.submit();
    }
    
    // Handle keypresses
    $(document).keypress(function(event) {
        if(event.charCode < 49) return;
        if(event.charCode > 48+{{ NUMBER_OF_STARS }}) return;
        var stars = event.charCode-48;
        rate($("form:has(.rating):first-child"), stars);
    });
});
</script>

{% endblock %}